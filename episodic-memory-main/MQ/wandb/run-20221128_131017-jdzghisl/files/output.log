---- Creamos un ViT ----
---- Creamos un ViT ----
---- Creamos un ViT ----
---- Creamos un ViT ----
---- Creamos un ViT ----
/home/s5091217/.local/lib/python3.9/site-packages/torch/nn/modules/lazy.py:178: UserWarning: Lazy modules are a new feature under heavy development so changes to the API or functionality can happen at any moment.
  warnings.warn('Lazy modules are a new feature under heavy development '
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x 4 : torch.Size([16, 256, 58]))
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x 4 : torch.Size([16, 256, 58]))
x 4 : torch.Size([16, 256, 58]))
x 0 : torch.Size([16, 256, 928])
x 2 : torch.Size([16, 256, 232])
x 4 : torch.Size([16, 256, 58]))
x 0 : torch.Size([16, 256, 928])
x 2 : torch.Size([16, 256, 232])
x 4 : torch.Size([16, 256, 58]))
x 4 : torch.Size([16, 256, 58]))
x 0 : torch.Size([16, 256, 928])
x 2 : torch.Size([16, 256, 232])
x 4 : torch.Size([16, 256, 58]))
x 0 : torch.Size([16, 256, 928])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 4 : torch.Size([16, 256, 58]))
x 4 : torch.Size([16, 256, 58]))
x 4 : torch.Size([16, 256, 58]))
x 2 : torch.Size([16, 256, 232])
x 4 : torch.Size([16, 256, 58]))
x 0 : torch.Size([16, 256, 928])
x 2 : torch.Size([16, 256, 232])
x 0 : torch.Size([16, 256, 928])
x 2 : torch.Size([16, 256, 232])
x 4 : torch.Size([16, 256, 58]))
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 4 : torch.Size([16, 256, 58]))
x 4 : torch.Size([16, 256, 58]))
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 4 : torch.Size([16, 256, 58]))
x 4 : torch.Size([16, 256, 58]))
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 4 : torch.Size([16, 256, 58]))
x 0 : torch.Size([16, 256, 928])
x 4 : torch.Size([16, 256, 58]))
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
x0: torch.Size([16, 256, 928])
x 0 : torch.Size([16, 256, 928])
x 1 : torch.Size([16, 256, 464])
x 2 : torch.Size([16, 256, 232])
x 3 : torch.Size([16, 256, 116])
x 4 : torch.Size([16, 256, 58])
Val loss (epoch 1):  loss: 5.8286 loss_cls_dec: 4.8211 loss_reg_dec: 0.3932 loss_action: 0.6672 loss_start: 0.6498 loss_end: 0.6314 loss_bd_adjust: 0.2247
2022-11-28 13:13:06.218269
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 0 : torch.Size([16, 256, 928])
x 2 : torch.Size([16, 256, 232])
x 4 : torch.Size([16, 256, 58]))
x 0 : torch.Size([16, 256, 928])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 4 : torch.Size([16, 256, 58]))
x 0 : torch.Size([16, 256, 928])
x 2 : torch.Size([16, 256, 232])
x 4 : torch.Size([16, 256, 58]))
x 4 : torch.Size([16, 256, 58]))
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 2 : torch.Size([16, 256, 232])
x 4 : torch.Size([16, 256, 58]))
x 4 : torch.Size([16, 256, 58]))
x 4 : torch.Size([16, 256, 58]))
x 4 : torch.Size([16, 256, 58]))
x 4 : torch.Size([16, 256, 58]))
x 4 : torch.Size([16, 256, 58]))
x 2 : torch.Size([16, 256, 232])
x 4 : torch.Size([16, 256, 58]))
The best model up to now is from Epoch 2
The best model up to now is from Epoch 2
x 0 : torch.Size([16, 256, 928]) Epoch 2
x 2 : torch.Size([16, 256, 232]) Epoch 2
x 4 : torch.Size([16, 256, 58])) Epoch 2
x 4 : torch.Size([16, 256, 58])) Epoch 2
x 0 : torch.Size([16, 256, 928]) Epoch 2
x 0 : torch.Size([16, 256, 928]) Epoch 2
x 2 : torch.Size([16, 256, 232]) Epoch 2
x 2 : torch.Size([16, 256, 232]) Epoch 2
x 2 : torch.Size([16, 256, 232]) Epoch 2
x 2 : torch.Size([16, 256, 232]) Epoch 2
x 2 : torch.Size([16, 256, 232]) Epoch 2
x 4 : torch.Size([16, 256, 58])) Epoch 2
x 0 : torch.Size([16, 256, 928]) Epoch 2
x 2 : torch.Size([16, 256, 232]) Epoch 2
x 2 : torch.Size([16, 256, 232]) Epoch 2
x 2 : torch.Size([16, 256, 232]) Epoch 2
x 2 : torch.Size([16, 256, 232]) Epoch 2
x 2 : torch.Size([16, 256, 232]) Epoch 2
x 2 : torch.Size([16, 256, 232]) Epoch 2
Traceback (most recent call last):
  File "/data/s5091217/code_ego4d/episodic-memory-main/MQ/Train.py", line 155, in <module>
    Train_VSGN(opt)
  File "/data/s5091217/code_ego4d/episodic-memory-main/MQ/Train.py", line 43, in Train_VSGN
    train_VSGN_epoch(train_loader, model, optimizer, epoch, writer, opt)
  File "/data/s5091217/code_ego4d/episodic-memory-main/MQ/Train.py", line 93, in train_VSGN_epoch
    epoch_losses['loss_cls_dec'] += loss_cls_dec.cpu().detach().numpy()
  File "/home/s5091217/.local/lib/python3.9/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 12853) is killed by signal: Killed.